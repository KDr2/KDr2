# -*- mode: org; mode: auto-fill -*-
#+TITLE: Code: output/script/site.js
#+AUTHOR: KDr2

#+BEGIN_SRC javascript :tangle ../output/script/site.js
/*
 * Tangled from tangle/site-js.org, do NOT edit this file.
 */
#+END_SRC

Init site domain and search box
#+BEGIN_SRC javascript :tangle ../output/script/site.js
  function init_site() {
      var url = window.location.href;
      var domain = url.replace(/^\w+:\/\//, "").replace(/\/.*$/gi,"").toLowerCase();
      var page = url.replace(/^\w+:\/\/.*?\//i,"").replace(/#.*$/gi,"");
      var site_name = "KDr2.com";
      $("#site-name").text(site_name);
      $("#sitesearch").val(domain);
  }
#+END_SRC

Init google analytics code
#+BEGIN_SRC javascript :tangle ../output/script/site.js
  function init_gat(){
      ga_cats['test'] = "TEST";
      ga_cats['donate'] = "DONATE";
      ga_cats['social'] = "SOCIAL";
      ga_spec['test-button']= [
          {
              'type' : ga_type.event_tracking,
              'arguments': {
                  category: ga_cats.test,
                  action: "click.button.test",
                  //label: function(e) { return "FUNC-LABEL";}
                  label: "DEFAULT_LABEL"
              },
              'events' : ['click', 'mouseover']
          }
      ];

      ga_spec['donate-link']= [
          {
              'type' : ga_type.event_tracking,
              'arguments': {
                  category: ga_cats.donate,
                  action: "link.header.click",
                  label: "DEFAULT-LABEL"
              },
              'events' : ['click']
          }
      ];

      ga_spec['social-link']= [
          {
              'type' : ga_type.event_tracking,
              'arguments': {
                  category: ga_cats.social,
                  action: "header.click",
                  label: "DEFAULT-LABEL"
              },
              'events' : ['click']
          }
      ];

      setup_ga('UA-45424100-1', 'kdr2.com');
      setup_simple_gat();
      $(".button_to_link").click(function(e){
          e.preventDefault();
          gat(e);
          var button = $(this);
          setTimeout(function(){
              button.parent("form").submit();
          }, 500);
      });
  }
#+END_SRC

Register document reday callback:
#+BEGIN_SRC javascript :tangle ../output/script/site.js
  $(document).ready(function(){
      init_site();
      init_gat();
  });
#+END_SRC
